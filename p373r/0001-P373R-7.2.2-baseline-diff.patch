diff --git a/llviewerdisplay.cpp b/llviewerdisplay.cpp
index fa6d16327a..3946ab35d2 100644
--- a/llviewerdisplay.cpp
+++ b/llviewerdisplay.cpp
@@ -26,6 +26,11 @@
 
 #include "llviewerprecompiledheaders.h"
 
+//################################### P373R ######################################
+#include "llviewerVR.cpp"
+llviewerVR gVR;
+//################################### END P373R ##################################
+
 #include "llviewerdisplay.h"
 
 #include "fsyspath.h"
@@ -833,6 +838,12 @@ void display(bool rebuild, F32 zoom_factor, int subfield, bool for_snapshot)
             gPipeline.toggleRenderType(LLPipeline::RENDER_TYPE_HUD_PARTICLES);
         }
 
+		//################################### P373R ######################################
+		sec:
+		gVR.ProcessVRCamera();
+		//################################### END P373R ##################################
+		
+
         stop_glerror();
         display_update_camera();
         stop_glerror();
@@ -1152,7 +1163,29 @@ void display(bool rebuild, F32 zoom_factor, int subfield, bool for_snapshot)
         if (!for_snapshot)
         {
             render_ui();
+			//################################### P373R ######################################
+			gVR.vrDisplay();
+
+			//################################### END P373R ######################################
+			//swap();
+			//################################### P373R ######################################
+			if (gVR.leftEyeDesc.IsReady  && !gVR.rightEyeDesc.IsReady && gVR.m_fEyeDistance > 0)
+			{
+				goto sec;
+
+
+			}
+			if (!gVR.leftEyeDesc.IsReady  && !gVR.rightEyeDesc.IsReady)
+			{
+				//gVR.HandleInput();
+
+			}
+			if (!gVR.m_bVrActive)
             swap();
+
+			//################################### END P373R ##################################
+			//swap();
+			
         }
 
 
@@ -1782,6 +1815,10 @@ void render_ui_3d()
     gUIProgram.bind();
     gGL.color4f(1.f, 1.f, 1.f, 1.f);
 
+	//################################### P373R ######################################
+	gVR.RenderControllerAxes();
+	//################################### END P373R ##################################
+
     // Coordinate axes
     static LLCachedControl<bool> show_axes(gSavedSettings, "ShowAxes");
     if (show_axes())
@@ -1929,6 +1966,10 @@ void render_ui_2d()
         gViewerWindow->draw();
     }
 
+	//################################### P373R ######################################
+	gVR.DrawCursors();
+	//################################### END P373R ##################################
+
     // reset current origin for font rendering, in case of tiling render
     LLFontGL::sCurOrigin.set(0, 0);
 }
@@ -2012,5 +2053,8 @@ void render_disconnected_background()
 
 void display_cleanup()
 {
+	//################################### P373R ######################################
+	gVR.vrStartup(TRUE);
+	//################################### END P373R ######################################
     gDisconnectedImagep = nullptr;
 }
